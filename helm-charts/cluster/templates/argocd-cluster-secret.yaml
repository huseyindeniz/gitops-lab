apiVersion: v1
kind: Secret
metadata:
  name: {{ .Values.clusterName }}-cluster-secret
  namespace: argocd
  labels:
    argocd.argoproj.io/secret-type: cluster
    argocd.argoproj.io/cluster: {{ .Values.clusterName }}
    argocd.argoproj.io/managed-by: argo-cd    
type: Opaque
stringData:
  name: {{ .Values.clusterName }}
  server: {{ .Values.server }}
  config: |
    bearerToken: 
      valueFrom:
        secretKeyRef:
          name: {{ .Values.bearerTokenSecretName }}
          key: {{ .Values.bearerTokenSecretKey }}
          namespace: {{ .Values.bearerTokenSecretNamespace }}
    tlsClientConfig:
      insecure: false
      caData: 
        valueFrom:
          secretKeyRef:
            name: {{ .Values.caDataSecretName }}
            key: {{ .Values.caDataSecretKey }}
            namespace: {{ .Values.caDataSecretNamespace }}
