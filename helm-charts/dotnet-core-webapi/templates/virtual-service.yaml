{{- if .Values.virtualService.enabled }}
apiVersion: networking.istio.io/v1alpha3
kind: VirtualService
metadata:
  name: {{ include "dotnet-core-webapi.fullname" . }}-virtualservice
  namespace: {{ include "dotnet-core-webapi.namespace" . }}
spec:
  hosts:
    {{- if .Values.virtualService.hosts }}
      {{- range .Values.virtualService.hosts }}
        - {{ . }}
      {{- end }}
    {{- else }}
      - {{ include "dotnet-core-webapi.name" . }}.{{ .Release.Namespace }}  # Default host if not set
    {{- end }}
  gateways:
    - {{ .Values.gateway }}
  http:
    - match:
        - uri:
            prefix: /api
      route:
        - destination:
            host: {{ include "dotnet-core-webapi.fullname" . }}-service
            port:
              number: {{ .Values.service.port }}  # The port of your service
{{- end }}
